<form class='form-inline' id='poi_form'>
	<input id='poi_id' name='poi_id' type='hidden' value='${poi.id}'>
	#{html/input id:'poi_street',     isAuthorized:isAuthorized,name:'Street',      primary:'true',                                                     placeholder:'e.g. Boltzmannstrasse',              value:poi?.street /}
	#{html/input id:'poi_housenumber',isAuthorized:isAuthorized,name:'House Number',primary:'true',                                                     placeholder:'e.g. 3',                             value:poi?.housenumber /}
	#{html/input id:'poi_postcode',   isAuthorized:isAuthorized,name:'Postal Code', primary:'true',                                                     placeholder:'e.g. 85748',                         value:poi?.postcode /}
	#{html/input id:'poi_city',       isAuthorized:isAuthorized,name:'City',        primary:'true',                                                     placeholder:'e.g. Garching',                      value:poi?.city /}
	#{html/input id:'poi_state',      isAuthorized:isAuthorized,name:'State',       primary:'true',                                                     placeholder:'e.g. Bavaria',                       value:poi?.state /}
	#{html/input id:'poi_country',    isAuthorized:isAuthorized,name:'Country',     primary:'true',                                                     placeholder:'e.g. Germany',                       value:poi?.country /}
	#{html/input id:'poi_accuracy',   isAuthorized:false,       name:'Accuracy (in meters)',primary:'true',                                             placeholder:'unknown',                            value:poi?.accuracy /}
	#{html/input id:'poi_altitude',   isAuthorized:false,       name:'Altitude (in meters)',primary:'true',                                             placeholder:'unknown',                            value:poi?.altitude /}
	#{html/input id:'poi_latitude',   isAuthorized:isAuthorized,name:'Latitude',    primary:'true',type:'number',min:'-90',max:'90',  step:'0.00000001',placeholder:'degrees (decimal; range [-90;90])',  value:poi?.latitude /}
	#{html/input id:'poi_longitude',  isAuthorized:isAuthorized,name:'Longitude',   primary:'true',type:'number',min:'-180',max:'180',step:'0.00000001',placeholder:'degress (decimal; range [-180;180])',value:poi?.longitude /}
	#{html/input id:'poi_provider',   isAuthorized:false,       name:'Provider for geodata',    primary:'true',                                         placeholder:'unknown',                            value:poi?.provider /}
	#{html/input id:'poi_start_time', isAuthorized:false,       name:'First photo taken at',primary:'true',type:'date',                                 placeholder:'unknown',                            value:poi?.start_time /}
	#{html/input id:'poi_end_time',   isAuthorized:false,       name:'Last photo taken at', primary:'true',type:'date',                                 placeholder:'unknown',                            value:poi?.end_time /}
	#{html/select_start id:'poi_power_tag',isAuthorized:isAuthorized,name:'Power Tag',primary:'true' /}
		#{html/option content:'Cable',selected:poi.powerTag.getClass().getSimpleName(),value:models.powerTags.Cable.class.getSimpleName() /}
		#{html/option content:'Cable Distribution Cabinet',selected:poi.powerTag.getClass().getSimpleName(),value:models.powerTags.CableDistributionCabinet.class.getSimpleName() /}
		#{html/option content:'Converter',selected:poi.powerTag.getClass().getSimpleName(),value:models.powerTags.Converter.class.getSimpleName() /}
		#{html/option content:'Generator',selected:poi.powerTag.getClass().getSimpleName(),value:models.powerTags.Generator.class.getSimpleName() /}
		#{html/option content:'Line',selected:poi.powerTag.getClass().getSimpleName(),value:models.powerTags.Line.class.getSimpleName() /}
		#{html/option content:'Minor Line',selected:poi.powerTag.getClass().getSimpleName(),value:models.powerTags.MinorLine.class.getSimpleName() /}
		#{html/option content:'Plant',selected:poi.powerTag.getClass().getSimpleName(),value:models.powerTags.Plant.class.getSimpleName() /}
		#{html/option content:'Pole',selected:poi.powerTag.getClass().getSimpleName(),value:models.powerTags.Pole.class.getSimpleName() /}
		#{html/option content:'Substation',selected:poi.powerTag.getClass().getSimpleName(),value:models.powerTags.Substation.class.getSimpleName() /}
		#{html/option content:'Switch',selected:poi.powerTag.getClass().getSimpleName(),value:models.powerTags.Switch.class.getSimpleName() /}
		#{html/option content:'Tower',selected:poi.powerTag.getClass().getSimpleName(),value:models.powerTags.Tower.class.getSimpleName() /}
		#{html/option content:'Transformer',selected:poi.powerTag.getClass().getSimpleName(),value:models.powerTags.Transformer.class.getSimpleName() /}
	#{html/select_end /}
	<div id='poi_power_tag_details'></div>
	<div id='poi_status'></div>
	#{if isAuthorized == true}
	<button class='btn btn-default' id='poi_submit' type="submit">Submit</button>
	#{/if}
</form>
#{if isAuthorized == true && poi && poi.googleUser &&
((poi.googleUser.accountType.name() == "USER"      && poi.taskStatus.name() == "TODO")||
 (poi.googleUser.accountType.name() == "SUPERUSER" && poi.taskStatus.name() != "SUBMITTED_TO_OSM"))}
	#{poi_delete_modal /}
#{/if}
#{poi_photos_modal photos:poi?.photos /}
<button class='btn btn-default' id='poi_zoom'>Zoom</button>
<button class='btn btn-default' id='poi_close'>Close</button>
#{if poi.taskStatus.status == 3}
<a class='btn btn-default' href='http://api06.dev.openstreetmap.org/node/${poi.osmNode.osmNodeId}' role='button' target='_blank'>Open OSM Website</a>
#{/if}
<script type='text/javascript'>
	(function() {
		$.get(
			routes.jsonPhoto.url(),
			$.param({poiId : $('#poi_id').val()}),
			function(data) {
				var photos = data.elements;
				for (var i = 0; i < photos.length; i++) {
					var photo = photos[i];
					addMarker(null, photo.latitude, photo.longitude, photo.marker_type, photo.marker_id, null, null);
				}
			}
		);
		$.get(
			routes.jsonLocationTrace.url(),
			$.param({poiId : $('#poi_id').val()}),
			function(data) {
				if (polygon) {
					map.removeLayer(polygon);
				}
				polygon = L.polygon(data).addTo(map);
			}
		);

	})();
</script>
